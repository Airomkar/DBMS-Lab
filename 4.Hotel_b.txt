Question -- The following tables form part of a database held in a relational DBMS: 
                Hotel (HotelNo, Name, City) HotelNo is primary key 
                Room (RoomNo, HotelNo, Type, Price) 
                Booking (HotelNo, GuestNo, DateFrom, DateTo, RoomNo) 
                Guest (GuestNo, GuestName, GuestAddress) GuestNo is primary key 
            Solve following queries by SQL 
                1. What is the total revenue per night from all double rooms? 
                2. List the details of all rooms at the Grosvenor Hotel, including the name of the guest staying in the room, if the room is occupied. 
                3. What is the average number of bookings for each hotel in April? 
                4. Create index on one of the field and show is performance in query. 
                5. List full details of all hotels. 
                6. List full details of all hotels in London. 
                7. Update the price of all rooms by 5%. 
                8. List the number of rooms in each hotel in London. 
                9. List all double or family rooms with a price below Â£40.00 per night, in ascending order of price.

Solution -- 

Step 1: Create Database

CREATE DATABASE hotelDB;
USE hotelDB;

Step 2: Create Tables

CREATE TABLE Hotel (
  HotelNo INT PRIMARY KEY,
  Name VARCHAR(50),
  City VARCHAR(30)
);

CREATE TABLE Room (
  RoomNo INT,
  HotelNo INT,
  Type VARCHAR(20),
  Price DECIMAL(10,2),
  PRIMARY KEY (HotelNo, RoomNo),
  FOREIGN KEY (HotelNo) REFERENCES Hotel(HotelNo)
);


CREATE TABLE Guest (
  GuestNo INT PRIMARY KEY,
  GuestName VARCHAR(50),
  GuestAddress VARCHAR(100)
);

CREATE TABLE Booking (
  HotelNo INT,
  GuestNo INT,
  DateFrom DATE,
  DateTo DATE,
  RoomNo INT,
  PRIMARY KEY (HotelNo, GuestNo, DateFrom),
  FOREIGN KEY (HotelNo, RoomNo) REFERENCES Room(HotelNo, RoomNo),
  FOREIGN KEY (GuestNo) REFERENCES Guest(GuestNo)
);

Step 3: Insert Sample Data

INSERT INTO Hotel VALUES
(1, 'Grosvenor Hotel', 'London'),
(2, 'Sea View Resort', 'Goa'),
(3, 'Hilltop Inn', 'Pune');

INSERT INTO Room VALUES
(101, 1, 'Single', 35.00),
(102, 1, 'Double', 60.00),
(103, 1, 'Family', 90.00),
(201, 2, 'Double', 55.00),
(301, 3, 'Single', 40.00),
(302, 3, 'Double', 65.00);

INSERT INTO Guest VALUES
(1, 'Amit Sharma', 'Mumbai'),
(2, 'Sneha Patil', 'Pune'),
(3, 'Ravi Kumar', 'Delhi');

INSERT INTO Booking VALUES
(1, 1, '2025-04-05', '2025-04-10', 102),
(1, 2, '2025-04-15', '2025-04-20', 103),
(2, 3, '2025-04-07', '2025-04-12', 201);

ðŸ§¾ SQL QUERIES AND ANSWERS

1. What is the total revenue per night from all double rooms?

