Question -- The following tables form part of a database held in a relational DBMS: 
                Hotel (HotelNo, Name, City) HotelNo is primary key 
                Room (RoomNo, HotelNo, Type, Price) 
                Booking (HotelNo, GuestNo, DateFrom, DateTo, RoomNo) 
                Guest (GuestNo, GuestName, GuestAddress) GuestNo is primary key 
            Solve following queries by SQL 
                1. What is the total revenue per night from all double rooms? 
                2. List the details of all rooms at the Grosvenor Hotel, including the name of the guest staying in the room, if the room is occupied. 
                3. What is the average number of bookings for each hotel in April? 
                4. Create index on one of the field and show is performance in query. 
                5. List full details of all hotels. 
                6. List full details of all hotels in London. 
                7. Update the price of all rooms by 5%. 
                8. List the number of rooms in each hotel in London. 
                9. List all double or family rooms with a price below Â£40.00 per night, in ascending order of price.

Solution -- 

Step 1: Create Database

CREATE DATABASE hotelDB;
USE hotelDB;

Step 2: Create Tables

CREATE TABLE Hotel (
  HotelNo INT PRIMARY KEY,
  Name VARCHAR(50),
  City VARCHAR(30)
);

CREATE TABLE Room (
  RoomNo INT,
  HotelNo INT,
  Type VARCHAR(20),
  Price DECIMAL(10,2),
  PRIMARY KEY (HotelNo, RoomNo),
  FOREIGN KEY (HotelNo) REFERENCES Hotel(HotelNo)
);


CREATE TABLE Guest (
  GuestNo INT PRIMARY KEY,
  GuestName VARCHAR(50),
  GuestAddress VARCHAR(100)
);

CREATE TABLE Booking (
  HotelNo INT,
  GuestNo INT,
  DateFrom DATE,
  DateTo DATE,
  RoomNo INT,
  PRIMARY KEY (HotelNo, GuestNo, DateFrom),
  FOREIGN KEY (HotelNo, RoomNo) REFERENCES Room(HotelNo, RoomNo),
  FOREIGN KEY (GuestNo) REFERENCES Guest(GuestNo)
);

Step 3: Insert Sample Data

INSERT INTO Hotel VALUES
(1, 'Grosvenor Hotel', 'London'),
(2, 'Sea View Resort', 'Goa'),
(3, 'Hilltop Inn', 'Pune');

INSERT INTO Room VALUES
(101, 1, 'Single', 35.00),
(102, 1, 'Double', 60.00),
(103, 1, 'Family', 90.00),
(201, 2, 'Double', 55.00),
(301, 3, 'Single', 40.00),
(302, 3, 'Double', 65.00);

INSERT INTO Guest VALUES
(1, 'Amit Sharma', 'Mumbai'),
(2, 'Sneha Patil', 'Pune'),
(3, 'Ravi Kumar', 'Delhi');

INSERT INTO Booking VALUES
(1, 1, '2025-04-05', '2025-04-10', 102),
(1, 2, '2025-04-15', '2025-04-20', 103),
(2, 3, '2025-04-07', '2025-04-12', 201);

ðŸ§¾ SQL QUERIES AND ANSWERS

1. What is the total revenue per night from all double rooms?

SELECT SUM(Price) AS Total_Revenue_Per_Night
FROM Room
WHERE Type = 'Double';

2. List details of all rooms at the Grosvenor Hotel, including the guest name if occupied.

SELECT r.RoomNo, r.Type, r.Price, g.GuestName
FROM Room r
JOIN Hotel h ON r.HotelNo = h.HotelNo
LEFT JOIN Booking b ON r.HotelNo = b.HotelNo AND r.RoomNo = b.RoomNo
LEFT JOIN Guest g ON b.GuestNo = g.GuestNo
WHERE h.Name = 'Grosvenor Hotel';

3. What is the average number of bookings for each hotel in April?

SELECT h.Name AS HotelName,
       COUNT(b.GuestNo) / COUNT(DISTINCT h.HotelNo) AS Avg_Bookings
FROM Hotel h
JOIN Booking b ON h.HotelNo = b.HotelNo
WHERE MONTH(b.DateFrom) = 4
GROUP BY h.Name;

4. Create index on one field and show its performance in a query.

-- Creating index on Room Type for faster searches
CREATE INDEX idx_room_type ON Room(Type);

-- Using the index in a query
EXPLAIN SELECT * FROM Room WHERE Type = 'Double';

5. List full details of all hotels.

SELECT * FROM Hotel;

6. SELECT * FROM Hotel

WHERE City = 'London';

7. Update the price of all rooms by 5%.

UPDATE Room
SET Price = Price * 1.05;

      If error occurs because of using "update without Where" - 
      then use aolution - 
            SET SQL_SAFE_UPDATES = 0;
            UPDATE Room
            SET Price = Price * 1.05;
            SET SQL_SAFE_UPDATES = 1;

8. List the number of rooms in each hotel in London.

SELECT h.Name AS HotelName, COUNT(r.RoomNo) AS No_of_Rooms
FROM Hotel h
JOIN Room r ON h.HotelNo = r.HotelNo
WHERE h.City = 'London'
GROUP BY h.Name;

9. List all double or family rooms with a price below Â£40.00 per night, in ascending order of price.

SELECT *
FROM Room
WHERE (Type = 'Double' OR Type = 'Family') AND Price < 40.00
ORDER BY Price ASC;

âœ… Query Summary Table

| No | Description                              | SQL Concepts Used                |
| -- | ---------------------------------------- | -------------------------------- |
| 1  | Total revenue from double rooms          | `SUM()`, `WHERE`                 |
| 2  | Room + guest details for Grosvenor Hotel | `JOIN`, `LEFT JOIN`              |
| 3  | Average bookings per hotel in April      | `COUNT()`, `MONTH()`, `GROUP BY` |
| 4  | Create and use an index                  | `CREATE INDEX`, `EXPLAIN`        |
| 5  | Show all hotel details                   | `SELECT *`                       |
| 6  | Hotels in London                         | `WHERE`                          |
| 7  | Increase price by 5%                     | `UPDATE`, `SET`                  |
| 8  | Count rooms in London hotels             | `JOIN`, `GROUP BY`               |
| 9  | Rooms under Â£40                          | `WHERE`, `ORDER BY`              |


ðŸŽ¤ POSSIBLE ORAL (VIVA) QUESTIONS & ANSWERS

| **Q.No** | **Question**                                                            | **Answer**                                                                                            |
| -------- | ----------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| 1        | What is a **Primary Key**?                                              | A column or set of columns that uniquely identifies each record in a table.                           |
| 2        | What is a **Foreign Key**?                                              | A column that refers to the primary key of another table, maintaining referential integrity.          |
| 3        | What is an **Index** in SQL?                                            | A database structure that improves the speed of data retrieval operations.                            |
| 4        | Difference between **Clustered** and **Non-clustered Index**?           | Clustered defines the physical order of data; non-clustered is a separate structure pointing to data. |
| 5        | What does `LEFT JOIN` do?                                               | It returns all rows from the left table and matching rows from the right table.                       |
| 6        | What is the use of **EXPLAIN** in SQL?                                  | It shows how MySQL executes a query and helps analyze performance.                                    |
| 7        | What is the use of the **SUM()** function?                              | It calculates the total of numeric values in a column.                                                |
| 8        | How do you find bookings in April?                                      | Use `MONTH(DateFrom) = 4` condition.                                                                  |
| 9        | What is the difference between `COUNT()` and `SUM()`?                   | `COUNT()` counts rows, `SUM()` adds up numeric values.                                                |
| 10       | What is the purpose of **GROUP BY**?                                    | It groups rows that have the same values for aggregate calculations.                                  |
| 11       | What does `ORDER BY Price ASC` mean?                                    | Sorts the records in ascending order based on price.                                                  |
| 12       | What is the role of **JOIN** in SQL?                                    | It combines data from two or more related tables based on matching fields.                            |
| 13       | What is a **subquery**?                                                 | A query inside another query used to compute or filter results dynamically.                           |
| 14       | What happens when you update a column using `SET Price = Price * 1.05`? | It increases every price value by 5%.                                                                 |
| 15       | Why do we normalize a database?                                         | To reduce redundancy and improve data integrity.                                                      |
