Question --  The following tables form part of a database held in a relational DBMS: 
                  Hotel (HotelNo, Name, City) HotelNo is the primary key 
                  Room (RoomNo, HotelNo, Type, Price) 
                  Booking (HotelNo, GuestNo, DateFrom, DateTo, RoomNo) 
                  Guest (GuestNo, GuestName, GuestAddress) 
              Solve following queries by SQL 
                  1. List full details of all hotels. 
                  2. How many hotels are there? 
                  3. List the price and type of all rooms at the Grosvenor Hotel. 
                  4. List the number of rooms in each hotel 
                  5. List all guests currently staying at the Grosvenor Hotel. 
                  6. List all double or family rooms with a price below Â£40.00 per night, in ascending order of 
                  price. 
                  7. How many different guests have made bookings for August? 
                  8. What is the total income from bookings for the Grosvenor Hotel today? 
                  9. What is the most commonly booked room type for each hotel in London? 
                  10. Update the price of all rooms by 5%. 

Solution -- 

Step 1: Create Database

CREATE DATABASE hotelDB;
USE hotelDB;

Step 2: Create Tables

CREATE TABLE Hotel (
  HotelNo INT PRIMARY KEY,
  Name VARCHAR(50),
  City VARCHAR(30)
);

CREATE TABLE Room (
  RoomNo INT,
  HotelNo INT,
  Type VARCHAR(20),
  Price DECIMAL(10,2),
  PRIMARY KEY (HotelNo, RoomNo),
  FOREIGN KEY (HotelNo) REFERENCES Hotel(HotelNo)
);

CREATE TABLE Guest (
  GuestNo INT PRIMARY KEY,
  GuestName VARCHAR(50),
  GuestAddress VARCHAR(100)
);

CREATE TABLE Booking (
  HotelNo INT,
  GuestNo INT,
  DateFrom DATE,
  DateTo DATE,
  RoomNo INT,
  PRIMARY KEY (HotelNo, GuestNo, DateFrom),
  FOREIGN KEY (HotelNo, RoomNo) REFERENCES Room(HotelNo, RoomNo),
  FOREIGN KEY (GuestNo) REFERENCES Guest(GuestNo)
);

Step 3: Insert Sample Data

INSERT INTO Hotel VALUES
(1, 'Grosvenor Hotel', 'London'),
(2, 'Sea View Resort', 'Goa'),
(3, 'Hilltop Inn', 'Pune');

INSERT INTO Room VALUES
(101, 1, 'Single', 35.00),
(102, 1, 'Double', 60.00),
(103, 1, 'Family', 90.00),
(201, 2, 'Double', 55.00),
(301, 3, 'Single', 40.00),
(302, 3, 'Double', 65.00);

INSERT INTO Guest VALUES
(1, 'Amit Sharma', 'Mumbai'),
(2, 'Sneha Patil', 'Pune'),
(3, 'Ravi Kumar', 'Delhi'),
(4, 'Priya Mehta', 'London');

INSERT INTO Booking VALUES
(1, 1, '2025-08-01', '2025-08-05', 102),
(1, 2, '2025-08-10', '2025-08-12', 103),
(1, 3, '2025-11-01', '2025-11-07', 101),
(2, 4, '2025-08-02', '2025-08-06', 201),
(3, 2, '2025-11-04', '2025-11-09', 301);

ðŸ§¾ SQL QUERIES AND ANSWERS

1. List full details of all hotels. 

SELECT * FROM Hotel;

2. How many hotels are there?

SELECT COUNT(*) AS Total_Hotels FROM Hotel;

3. List the price and type of all rooms at the Grosvenor Hotel.

SELECT r.Type, r.Price
FROM Room r
JOIN Hotel h ON r.HotelNo = h.HotelNo
WHERE h.Name = 'Grosvenor Hotel';

4. List the number of rooms in each hotel.

SELECT h.Name AS Hotel_Name, COUNT(r.RoomNo) AS Number_of_Rooms
FROM Hotel h
JOIN Room r ON h.HotelNo = r.HotelNo
GROUP BY h.Name;

5. List all guests currently staying at the Grosvenor Hotel.

SELECT g.GuestName, b.RoomNo, b.DateFrom, b.DateTo
FROM Guest g
JOIN Booking b ON g.GuestNo = b.GuestNo
JOIN Hotel h ON b.HotelNo = h.HotelNo
WHERE h.Name = 'Grosvenor Hotel'
  AND CURDATE() BETWEEN b.DateFrom AND b.DateTo;

6. List all double or family rooms with a price below Â£40.00 per night, in ascending order of price.

SELECT *
FROM Room
WHERE (Type = 'Double' OR Type = 'Family') AND Price < 40.00
ORDER BY Price ASC;

7. How many different guests have made bookings for August?

SELECT COUNT(DISTINCT GuestNo) AS Total_Guests
FROM Booking
WHERE MONTH(DateFrom) = 8;

8. What is the total income from bookings for the Grosvenor Hotel today?

SELECT SUM(r.Price) AS Total_Income
FROM Room r
JOIN Booking b ON r.HotelNo = b.HotelNo AND r.RoomNo = b.RoomNo
JOIN Hotel h ON r.HotelNo = h.HotelNo
WHERE h.Name = 'Grosvenor Hotel'
  AND CURDATE() BETWEEN b.DateFrom AND b.DateTo;

9. What is the most commonly booked room type for each hotel in London?

SELECT h.Name AS HotelName, r.Type, COUNT(*) AS Bookings
FROM Hotel h
JOIN Room r ON h.HotelNo = r.HotelNo
JOIN Booking b ON r.HotelNo = b.HotelNo AND r.RoomNo = b.RoomNo
WHERE h.City = 'London'
GROUP BY h.Name, r.Type
HAVING COUNT(*) >= ALL (
    SELECT COUNT(*)
    FROM Booking b2
    JOIN Room r2 ON b2.HotelNo = r2.HotelNo
    WHERE r2.HotelNo = r.HotelNo
    GROUP BY r2.Type
);

10. Update the price of all rooms by 5%.

UPDATE Room
SET Price = Price * 1.05;

      If error occurs because of using "update without Where" - 
      then use aolution - 
            SET SQL_SAFE_UPDATES = 0;
            UPDATE Room
            SET Price = Price * 1.05;
            SET SQL_SAFE_UPDATES = 1;

âœ… Query Summary Table

| No | Description                    | SQL Concepts Used              |
| -- | ------------------------------ | ------------------------------ |
| 1  | List hotel details             | `SELECT *`                     |
| 2  | Count hotels                   | `COUNT()`                      |
| 3  | Rooms in Grosvenor Hotel       | `JOIN`, `WHERE`                |
| 4  | Number of rooms per hotel      | `GROUP BY`                     |
| 5  | Current guests                 | `JOIN`, `CURDATE()`            |
| 6  | Filter rooms by type and price | `WHERE`, `ORDER BY`            |
| 7  | Distinct August guests         | `DISTINCT`, `MONTH()`          |
| 8  | Total income today             | `SUM()`, `JOIN`, `DATE FILTER` |
| 9  | Most common room type          | `GROUP BY`, `HAVING`, `ALL`    |
| 10 | Increase room price            | `UPDATE`, `SET`                |

ðŸŽ¤ POSSIBLE ORAL (VIVA) QUESTIONS & ANSWERS

| **Q.No** | **Question**                                                      | **Answer**                                                                            |
| -------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------- |
| 1        | What is a **Primary Key**?                                        | It uniquely identifies each record in a table and cannot be NULL.                     |
| 2        | What is a **Foreign Key**?                                        | It links one table to another by referencing the primary key of another table.        |
| 3        | What is the use of `JOIN`?                                        | It combines rows from two or more tables based on related columns.                    |
| 4        | What does `GROUP BY` do?                                          | Groups records with the same value in one or more columns.                            |
| 5        | What is the difference between `WHERE` and `HAVING`?              | `WHERE` filters before grouping; `HAVING` filters after grouping.                     |
| 6        | What does `COUNT(DISTINCT ...)` do?                               | It counts only unique (non-duplicate) values.                                         |
| 7        | What is the use of `CURDATE()` in MySQL?                          | It returns the current system date.                                                   |
| 8        | What is the function of `SUM()`?                                  | Adds up all numeric values in a column.                                               |
| 9        | What does the query `SET Price = Price * 1.05` do?                | Increases every roomâ€™s price by 5%.                                                   |
| 10       | What is a subquery?                                               | A query inside another query used for dynamic filtering or comparison.                |
| 11       | What is the difference between `INNER JOIN` and `LEFT JOIN`?      | `INNER JOIN` returns only matches; `LEFT JOIN` includes all rows from the left table. |
| 12       | What is the purpose of `ORDER BY`?                                | To arrange query results in ascending or descending order.                            |
| 13       | How can you find bookings in a specific month?                    | By using the `MONTH()` function on the booking date.                                  |
| 14       | What happens if you omit the `WHERE` clause in an `UPDATE` query? | It updates all records in the table.                                                  |
| 15       | What is normalization?                                            | The process of organizing data to reduce redundancy and improve integrity.            |
